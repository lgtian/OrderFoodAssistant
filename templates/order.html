{% extends "base.html" %}

{% block head %}
    {{ super() }}
    <title>订餐助手</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='order/order.css') }}">
{% endblock %}
{% block page_content %}
    <div class="view-order">
        {% if isNextWeek=='0' %}
            <div class="order-notice">
                1）午餐需在前一日 15:00 之前预定<br>
                2）晚餐可在当日的 15:00 之前预定<br>
                3）周五15:00后可预定下周套餐
            </div>
        {% endif %}
        {% if isNextWeek=='1' %}
            <div class="order-notice" style="text-align: center">
                <span style="color: #2B448E">本周预定已结束，当前可预定下周套餐</span>
            </div>
        {% endif %}

        <!-- 菜单列表-->
        <div class="activity-list">
            {% for activity in activity_list %}
                <div class="activity_item">
                    <div style="display: flex;align-items: center">
                        <!-- 菜单类型：午餐，晚餐-->
                        {% if activity.activityType=='午餐' %}
                            <div class="activity-type-lunch">午</div>
                        {% else %}
                            <div class="activity-type-supper">晚</div>
                        {% endif %}

                        <!-- 菜单信息-->
                        <div class="activity-info">
                            <div class="activity-date">{{ activity.date }}</div>
                            {% if activity.ordered == '1' %}
                                <div class="activity-ordered-info">{{ activity.activitySubType }}
                                    x{{ activity.total }}</div>
                            {% else %}
                                <div class="activity-unordered-info">{{ activity.activitySubType }}（未预定)</div>
                            {% endif %}
                        </div>
                    </div>

                    <!-- 操作按钮-->
                    {% if activity.ordered == '1' %}
                        <div class="btn-modify" onclick="openOrderDialog({{ activity.activityDetailId }})">修改</div>
                    {% else %}
                        <div class="btn-order" onclick="openOrderDialog({{ activity.activityId }})">预定</div>
                    {% endif %}
                </div>
            {% endfor %}
        </div>

        <!-- 底部tab按钮-->
        <div class="bottom-tab-bar">
            <div style="color:#84AFEF">
                <div class="icon-order"></div>
                订餐
            </div>
            <a style="color:#93959D; text-decoration: none" href="{{ url_for('statistics') }}">
                <div class="icon-statistics"></div>
                汇总
            </a>
        </div>
    </div>

    <div id="orderDialogView" class="view-dialog-order">
        <div class="view flex flex-center-middle">
            <div class="dialog-order-body">
                <div class="dialog-order-header">
                    <div class="header-title">午餐 . 2020-02-18（周二）</div>
                    <div class="header-close" onclick="closeOrderDialog()"></div>
                </div>
                <div class="dialog-order-content">
                    <form action="order", method="post">
                        <div class="flex content-item">
                            <div class="content-label">套餐：</div>
                            <div class="flex-1 flex flex-x-end">
                                <input class="input-radio"
                                       id="order_type_11"
                                       checked name="order_type" type="radio" value="0"/>
                                <label class="input-radio-label first" for="order_type_11"></label>
                                <label class="" for="order_type_11">11元套餐</label>

                                <input class="input-radio"
                                       id="order_type_16"
                                       name="order_type" type="radio" value="1"/>
                                <label class="input-radio-label" for="order_type_16"></label>
                                <label class="" for="order_type_16">16元套餐</label>
                                <input id="activityId" type="text" name="activityId" style="display: none">
                            </div>
                        </div>
                        <div class="flex content-item">
                            <div class="content-label">份数：</div>
                            <div class="flex-1">
                                <input class="input-text text-right" type="number" min="1" name="order_count">
                            </div>
                        </div>
                        <input class="content-btn" type="submit" value="提交"/>
                    </form>
                </div>
            </div>
        </div>
    </div>

{% endblock %}
{% block page_script %}
    <script>
        function openOrderDialog(activityId) {
            document.querySelector('#orderDialogView').style.display = 'block';
            document.querySelector('#activityId').value = activityId;
        }

        function closeOrderDialog() {
            document.querySelector('#orderDialogView').style.display = 'none';
            document.querySelector('#orderDialogView form').reset();
        }

        function openUpdateDialog(activityDetailId) {
            document.querySelector('#orderDialogView').style.display = 'block';
            document.querySelector('#activityDetailId').value = activityDetailId;
        }

        function closeUpdateDialog() {
            document.querySelector('#orderDialogView').style.display = 'none';
            document.querySelector('#orderDialogView form').reset();
        }
    </script>
{% endblock %}
</html>